#define	IHaveSubdirs

SUBDIRS = mkbrowse atkprogramming

README: README.ez
	ExecuteFromBASEDIR(ez2ascii README.ez > README)
CleanTarget(README)

InstallFile(README, $(INSTMANFLAGS), ${DESTDIR})
InstallDocs(README.ez, ${DESTDIR}/doc/ADMINISTRATOR)
InstallDocs(FAQ.ez, ${DESTDIR}/doc/ADMINISTRATOR)
InstallDocs(CONTENTS.ez, ${DESTDIR}/doc)
InstallDocs(COPYRITE,${DESTDIR}/doc)
InstallDocs(COPYRITE.bls,${DESTDIR}/doc)
InstallDocs(COPYRITE.att,${DESTDIR}/doc)
InstallDocs(COPYRITE.img,${DESTDIR}/doc)

install.time:: 
	$(RM) $(DESTDIR)/COPYRITE
	$(LN) doc/COPYRITE $(DESTDIR)/COPYRITE

#if defined(MK_PREFS) || defined(MK_AUX_UTILS)

STARPR = *.pr
prefs.def: ${DESTDIR}/lib/prs
	$(RM) prefs.def
	ExecuteFromBASEDIR(datacat ${DESTDIR}/lib/prs/${STARPR} > prefs.def )
InstallFile(prefs.def, $(INSTMANFLAGS), ${DESTDIR}/lib)
CleanTarget(prefs.def)
#endif

/* No, I will not bother with #ifdef DOXYGEN_ENV or some such */
latex/hierarchy.tex: $(shell find $(DESTDIR)/include -type f) doxyfile add_group
	$(RM) -rf latex html
	sed -e 's#$${ANDREWDIR}#$(DESTDIR)#g' < doxyfile | doxygen -

refman.pdf: latex/hierarchy.tex
	(cd latex; make)
	$(CP) latex/refman.pdf .

InstallFile(refman.pdf,${INSTMANFLAGS},${DESTDIR}/doc/PROGRAMMER)
CleanTarget(-r latex html doxygen*.tmp refman.pdf)

#ifdef FUNCTION_INDEX_ENV

FunctionIndex:
	${RM} ,FunctionIndex
	(cd ..; $(BASEDIR)/etc/getnms) > ,FunctionIndex
	${RM} FunctionIndex
	mv ,FunctionIndex FunctionIndex

InstallFile(FunctionIndex,${INSTMANFLAGS},${DESTDIR}/doc/PROGRAMMER)
CleanTarget(FunctionIndex)
#endif /* FUNCTION_INDEX_ENV */

