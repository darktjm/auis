/* ********************************************************************** *\
 *         Copyright IBM Corporation 1988,1991 - All Rights Reserved      *
 *        For full copyright information see:'andrew/doc/COPYRITE'        *
\* ********************************************************************** */

DEFINES = -Dboolean=int 


#if  !defined(ANSI_COMPILER) || defined(NONANSI_INCLUDES)
all:: ansi2knr
ansi2knr: ansi2knr.c
	$(RM) $@
	$(CC) -o $@ $(CFLAGS) ansi2knr.c
clean:: ; $(RM) ansi2knr
#endif

/* headers to install */
INCS = jinclude.h jconfig.h jpegdata.h

/* objectfiles common to cjpeg and djpeg */
COMOBJECTS= jutils.o jerror.o jmemmgr.o jmemsys.o

/* compression objectfiles */
CLIBOBJECTS= jcmaster.o jcdeflts.o jcarith.o jccolor.o jcexpand.o jchuff.o \
        jcmcu.o jcpipe.o jcsample.o jfwddct.o jwrjfif.o jrdgif.o jrdppm.o \
        jrdrle.o jrdtarga.o
COBJECTS= jcmain.o $(CLIBOBJECTS) $(COMOBJECTS)

/* decompression objectfiles */
DLIBOBJECTS= jdmaster.o jddeflts.o jbsmooth.o jdarith.o jdcolor.o jdhuff.o \
        jdmcu.o jdpipe.o jdsample.o jquant1.o jquant2.o jrevdct.o jrdjfif.o \
        jwrgif.o jwrppm.o jwrrle.o jwrtarga.o
DOBJECTS= jdmain.o $(DLIBOBJECTS) $(COMOBJECTS)

/* These objectfiles are included in libjpeg.a */
LIBOBJECTS= $(CLIBOBJECTS) $(DLIBOBJECTS) $(COMOBJECTS)

OBJS = ${LIBOBJECTS}
#ifdef  ANSI_COMPILER
NormalObjectRule()
#else
.c.o:			
	$(RM) $@ tempfile.c
	./ansi2knr $*.c tempfile.c
	$(CC) -c $(CFLAGS) tempfile.c
	$(MV) tempfile.o $*.o
#endif
ProgramTarget(cjpep, ${COBJECTS},,)
ProgramTarget(djpep, ${COBJECTS},,)
LibraryTarget(libjpeg.a, ${LIBOBJECTS})

InstallLibrary(libjpeg.a, ${BASEDIR}/lib)
InstallMultiple(${INCS}, ${INSTINCFLAGS}, ${BASEDIR}/include)

InstallDocs(cjpeg.help djpeg.help, $(DESTDIR)/help)

DependTarget()
